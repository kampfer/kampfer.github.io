!function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],h=0,u=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);u.length;)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==r[l]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={0:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;i.push([45,1]),n()}([,,,,,,,,,,,,,,function(e,t){e.exports="data:image/png;base64,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"},,,,,function(e,t,n){},,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(8),s=n.n(i),o=n(9),l=n.n(o);n(19);class c extends r.a.Component{render(){let e=this.props,t="grid-container";return e.vertical&&(t+=" vertical"),r.a.createElement("div",{className:t},e.children)}}class d extends r.a.Component{constructor(e){super(e)}render(){let e,t=this.props,n=t.width,a=t.height,i={flexGrow:t.flexGrow,width:n};return void 0!==n&&void 0!==a&&console.warn("Grid.render: 不允许同时设置width和height"),void 0!==n&&(e=n),void 0!==a&&(e=a),i.flexBasis=e,r.a.createElement("div",{className:"grid",style:i},t.children)}}var h=n(2),u=n.n(h),m=n(3),f=n.n(m),p=n(4),g=n.n(p),E=n(5),y=n.n(E),v=n(6),w=n.n(v),C=n(7),_=n.n(C);var A=function(e){return e.arrayBuffer()},b={gltf:function(e){return e.json()},glb:A,bin:A},P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.baseUrl,a=t.urlModifier;u()(this,e),this.baseUrl=n,this.urlModifier=a,this._requstingPool={}}return f()(e,[{key:"extname",value:function(e){return _.a.extname(e).slice(1)}},{key:"formatResponse",value:function(e,t){var n=this.extname(t);return b[n](e)}},{key:"load",value:function(e){var t=this;if(e in this._requstingPool)return this._requstingPool[e];!function(e){return/^https?:\/\//.test(e)||"/"===e.charAt(0)}(e)&&this.baseUrl&&(e="".concat(this.baseUrl,"/").concat(e));var n=e;this.urlModifier&&(n=this.urlModifier.call(this,e)),console.log("request: ".concat(e,"(").concat(n,")"));var a=fetch(n,{mode:"cors"}).then((function(n){if(n.ok)return t.formatResponse(n,e);throw"Network response was not ok."}));return this._requstingPool[e]=a,a}}]),e}(),T=n(1);function k(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,a=e.length;n<a;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}var N=1313821514,M=5130562,S="KHR_binary_glTF";function R(e){this.name=S,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:k(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},"glTF"!==this.header.magic)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected.");for(var n=new DataView(e,12),a=0;a<n.byteLength;){var r=n.getUint32(a,!0);a+=4;var i=n.getUint32(a,!0);if(a+=4,i===N){var s=new Uint8Array(e,12+a,r);this.content=k(s)}else if(i===M){var o=12+a;this.body=e.slice(o,o+r)}a+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}var O=function(e){function t(e){var n;u()(this,t);var a=[],r=[],i=new T.Color(16711680),s=new T.Color(43775),o={};function l(e,t,n){c(e,n),c(t,n)}function c(e,t){a.push(0,0,0),r.push(t.r,t.b,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(a.length/3-1)}l("p","n1",i),l("p","n2",i),l("p","n3",i),l("p","n4",i),l("n1","n2",i),l("n2","n3",i),l("n3","n4",i),l("n4","n1",i),l("u1","u2",s),l("u2","u3",s),l("u3","u1",s);var d=new T.Geometry,h=new T.LineBasicMaterial({vertexColors:!0});return d.setAttribute("position",new T.BufferAttribute(new Float32Array(a),3)),d.setAttribute("color",new T.BufferAttribute(new Float32Array(r),3)),(n=g()(this,y()(t).call(this,d,h))).position.copy(e.position),n.quaternion.copy(e.quaternion),n.scale.copy(e.scale),n.camera=e,n.name=e.name,n.isCameraHelper=!0,n._pointMap=o,n.update(new T.Vec3(1,1,1)),n}return w()(t,e),f()(t,[{key:"update",value:function(e){var t=this.geometry.getAttribute("position"),n=this._pointMap,a=function(a,r,i,s){var o=n[a];if(o)for(var l=0,c=o.length;l<c;l++)t.setXYZ(o[l],r*e.x,i*e.y,s*e.z)};a("p",0,0,0),a("n1",1,1,-1),a("n2",-1,1,-1),a("n3",-1,-1,-1),a("n4",1,-1,-1),a("u1",.7,1.1,-1),a("u2",0,2,-1),a("u3",-.7,1.1,-1)}}]),t}(T.LineSegments);class U extends T.Interpolant{_interpolate(e,t,n,a){let r=this.yArray,i=this.ySize,s=2*i,o=3*i,l=new r.constructor(i),c=(n-t)/(a-t),d=c*c,h=d*c,u=-2*h+3*d,m=h-d,f=1-u,p=m-d+c,g=a-t,E=e*o,y=E-o;for(let e=0;e<i;e++){let t=r[y+e+i],n=r[E+e+i],a=r[y+e+s]*g,o=r[E+e]*g;l[e]=f*t+p*a+u*n+m*o}return l}}const{LINEAR_INTERPOLATION:L,STEP_INTERPOLATION:F,CUBIC_SPLINE_INTERPOLATION:K,OBJECT_TYPE_PERSPECTIVE_CAMERA:D,OBJECT_TYPE_ORTHOGRAPHIC_CAMERA:Y,OBJECT_TYPE_MESH:x,OBJECT_TYPE_SKINNED_MESH:B}=T.constants,V={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",JOINTS_0:"skinIndex",WEIGHTS_0:"skinWeight"},I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},G={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},z={translation:T.VectorKeyFrameTrack,rotation:T.QuaternionKeyFrameTrack,scale:T.VectorKeyFrameTrack,weights:T.NumberKeyFrameTrack},j={translation:"position",rotation:"quaternion",scale:"scale",weights:"morphTargetInfluences"},H={LINEAR:L,STEP:F,CUBICSPLINE:K},W="GLB",q="GLTF";class J{constructor(e){this._loader=e.loader,this._cache=null}reset(e,t){this._cache={},this._data=e,this._meshReferences=null,this._meshUses=null,this._type=t}_parse(e,t){let n=e+":"+t,a=this._cache[n];if(!a){switch(e){case"scene":a=this.parseScene(t);break;case"node":a=this.parseNode(t);break;case"mesh":a=this.parseMesh(t);break;case"material":a=this.parseMaterial(t);break;case"accessor":a=this.parseAccessor(t);break;case"bufferView":a=this.parseBufferView(t);break;case"buffer":a=this.parseBuffer(t);break;case"camera":a=this.parseCamera(t);break;case"animation":a=this.parseAnimation(t);break;case"skin":a=this.parseSkin(t);break;default:console.warn("GLTFParser：不支持的属性类型："+e)}this._cache[n]=a}return a}parse(e){let t;return t=e instanceof ArrayBuffer?this.parseArrayBuffer(e):this.parseJson(e),t.catch(e=>console.error(e))}parseArrayBuffer(e){let t=new R(e),n=t.content;return e=JSON.parse(n),console.log("glTF Data:",e),this._binaryReader=t,this.reset(e,W),this.markDefs(),Promise.all([this.parseScenes(),this.parseAnimations(),this.parseCameras()]).then((function(t){let[n,a,r]=t;return{asset:e.asset,scenes:n,scene:e.scene,cameras:r,animations:a}}))}parseJson(e){return console.log("glTF Data:",e),this.reset(e,q),this.markDefs(),Promise.all([this.parseScenes(),this.parseAnimations(),this.parseCameras()]).then((function(t){let[n,a,r]=t;return{asset:e.asset,scenes:n,scene:e.scene,cameras:r,animations:a}}))}markDefs(){let e=this._data,t=e.nodes,n=e.meshes,a=e.skins||[];for(let e=0,n=a.length;e<n;e++){let n=a[e].joints;for(let e=0,a=n.length;e<a;e++){t[n[e]].isBone=!0}}let r={},i={};for(let e=0,a=t.length;e<a;e++){let a=t[e];if(void 0!==a.mesh){let e=a.mesh;void 0===r[e]&&(i[e]=0,r[e]=0),r[e]++,void 0!==a.skin&&(n[e].isSkinnedMesh=!0)}}this._meshReferences=r,this._meshUses=i}parseScenes(){let e=this._data;return Promise.all(e.scenes.map((e,t)=>this._parse("scene",t)))}parseAnimations(){let e=this._data.animations||[];return Promise.all(e.map((e,t)=>this._parse("animation",t)))}parseCameras(){let e=this._data.cameras||[];return Promise.all(e.map((e,t)=>this._parse("camera",t)))}parseAnimation(e){let t=this._data.animations[e],n=t.channels,a=t.samplers,r=[],i=[],s=[],o=[],l=[];for(let e=0,t=n.length;e<t;e++){let t=n[e],c=a[t.sampler],d=t.target,h=d.node,u=c.input,m=c.output;r.push(this._parse("node",h)),i.push(this._parse("accessor",u)),s.push(this._parse("accessor",m)),o.push(c),l.push(d)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(l)]).then((function(n){let[a,r,i,s,o]=n,l=[];for(let e=0,t=a.length;e<t;e++){let t=a[e],n=r[e],c=i[e],d=s[e],h=o[e],u=z[h.path];if(c.normalized){let e,t=c.array;t.constructor===Int8Array?e=1/127:t.constructor===Uint8Array?e=1/255:t.constructor===Int16Array?e=1/32767:t.constructor===Uint16Array?e=1/65535:console.warn("GLTFParser：不支持的typearray类型");let n=new Float32Array(t.length);for(let a=0,r=t.length;a<r;a++)n[a]=t[a]*e;t=n}let m=new u(t,j[h.path],n.array,c.array,H[d.interpolation]);"CUBICSPLINE"===d.interpolation&&(m.interpolant=new U(m.times,m.values,m.getValueSize()/3)),l.push(m)}let c=void 0!==t.name?t.name:"animation_"+e;return new T.AnimationClip(c,void 0,l)}))}_buildNodeHierachy(e,t){let n=this._data.nodes[e].children;return this._parse("node",e).then(e=>{if(t.add(e),n)for(let t=0,a=n.length;t<a;t++)this._buildNodeHierachy(n[t],e);return e})}parseScene(e){let t=this._data.scenes[e].nodes,n=new T.Scene;return Promise.all(t.map(e=>this._buildNodeHierachy(e,n))).then(()=>n)}parseNode(e){let t=this._data.nodes[e],n=[];return void 0!==t.mesh&&n.push(this._parse("mesh",t.mesh).then(e=>{let n=this._meshReferences,a=this._meshUses,r=e;if(n[t.mesh]>1){let n=a[t.mesh];r=e.clone(),r.name+=`_instance_${n}`;for(let e=0,t=r.children.length;e<t;e++)r.children[e].name+=`_instance_${n}`}return void 0!==t.weights&&r.traverse(e=>{if(e.type===x)for(let n=0,a=t.weights.length;n<a;n++)e.morphTargetInfluences[n]=t.weights[n]}),r})),void 0!==t.camera&&n.push(this._parse("camera",t.camera)),Promise.all(n).then(e=>{let n;if(t.isBone?n=new T.Bone:1===e.length?(n=e[0],n.type!==D&&n.type!==Y||(n=new O(n))):n=e.length>1?new T.Group:new T.GraphObject,n!==e[0])for(let t=0,a=e.length;t<a;t++)n.add(e[t]);if(void 0!==t.name&&(n.name=t.name),t.matrix){let e=new T.Mat4(t.matrix);n.applyMatrix(e)}else t.translation&&n.position.setFromArray(t.translation),t.rotation&&n.quaternion.setFromArray(t.rotation),t.scale&&n.scale.setFromArray(t.scale);return n}).then(e=>void 0===t.skin?e:this._parse("skin",t.skin).then(t=>{let n=t.jointNodes;return e.traverse(e=>{if(e.type!==B)return;let a=[],r=[];for(let e=0,i=n.length;e<i;e++){let i=n[e];if(i){a.push(i);let n=new T.Mat4;void 0!==t.inverseBindMatrices&&n.setFromArray(t.inverseBindMatrices.array,16*e),r.push(n)}}e.bind(new T.Skeleton(a,r),e.worldMatrix)}),e}))}parseSkin(e){let t=this._data.skins[e];return Promise.all([Promise.all(t.joints.map(e=>this._parse("node",e))),t.inverseBindMatrices?this._parse("accessor",t.inverseBindMatrices):null]).then(e=>{let[t,n]=e;return{inverseBindMatrices:n,jointNodes:t}})}parseMesh(e){let t=this._data.meshes[e],n=t.primitives,a=[],r=[];a.push(Promise.all(n.map(e=>this.loadGeometry(e))));for(let e=0,t=n.length;e<t;e++)r.push(this.parseMaterial(n[e].material));return a.push(r),Promise.all(a).then(a=>{let[r,i]=a,s=[];for(let a=0,o=r.length;a<o;a++){let o,l=r[a],c=n[a],d=i[a];switch(c.mode){case T.constants.GL_DRAW_MODE_TRIANGLE_STRIP:case T.constants.GL_DRAW_MODE_TRIANGLE_FAN:case T.constants.GL_DRAW_MODE_LINES:case T.constants.GL_DRAW_MODE_LINE_STRIP:case T.constants.GL_DRAW_MODE_LINE_LOOP:case T.constants.GL_DRAW_MODE_POINTS:case T.constants.GL_DRAW_MODE_TRIANGLES:default:o=t.isSkinnedMesh?new T.SkinnedMesh(l,d):new T.Mesh(l,d)}o.type!==B||o.geometry.getAttribute("skinWeight").normalized||o.normalizeSkinWeights();let h=void 0!==l.getAttribute("color"),u=!0===t.isSkinnedMesh,m=l.getMorphAttributes(),f=Object.keys(m).length>0,p=f&&void 0!==l.getMorphAttribute("normal");d.vertexColors=h,d.morphTargets=f,d.morphNormals=p,d.skinning=u,o.name=t.name||`mesh_${e}`,r.length>1&&(o.name+=`_${a}`),s.push(o)}if(1===s.length)return s[0];let o=new T.Group;for(let e=0,t=s.length;e<t;e++)o.add(s[e]);return o})}parseCamera(e){let t,n=this._data.cameras[e];if("perspective"===n.type){let{yfov:e,aspectRatio:a,zfar:r,znear:i}=n.perspective;t=new T.PerspectiveCamera(e,a,i,r)}else{if("orthographic"!==n.type)throw"不支持的camera类型";{let{xmag:e,ymag:a,zfar:r,znear:i}=n.orthographic;t=new T.OrthographicCamera(-e/2,e/2,a/2,-a/2,r,i)}}return t.name=n.name||`${n.type}Camera.${e}`,t}loadGeometry(e){let t=e.attributes,n=new T.Geometry,a=[];for(let e in t){let r=V[e],i=t[e];a.push(this._parse("accessor",i).then((function(e){n.setAttribute(r,e)})))}return void 0!==e.indices&&a.push(this._parse("accessor",e.indices).then((function(e){n.setIndex(e)}))),Promise.all(a).then(()=>void 0!==e.targets?this.addMorphAttributes(n,e.targets):n)}addMorphAttributes(e,t){let n=!1,a=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(a=!0),n&&a)break}if(!n&&!a)return Promise.resolve(e);let r=[],i=[];for(let s=0,o=t.length;s<o;s++){let o=t[s];if(n){let t=void 0!==o.POSITION?this._parse("accessor",o.POSITION):e.attributes.position;r.push(t)}if(a){let t=void 0!==o.NORMAL?this._parse("accessor",o.NORMAL):e.attributes.normal;i.push(t)}}return Promise.all([Promise.all(r),Promise.all(i)]).then((function(t){let r=t[0],i=t[1];return n&&e.setMorphAttribute("position",r),a&&e.setMorphAttribute("normal",i),e.morphTargetsRelative=!0,e}))}parseMaterial(e){let t=this._data,n=new T.Material;if(t.materials&&t.materials[e]){let a=t.materials[e];n.color=new T.Color(a.pbrMetallicRoughness.baseColorFactor||[1,1,1]),n.metallicFactor=a.pbrMetallicRoughness.metallicFactor||1,n.roughnessFactor=a.pbrMetallicRoughness.roughnessFactor||1}else n.color=new T.Color([0,0,0,1]);return n}parseAccessor(e){let t=this._data,n=t.accessors[e],a=[];return void 0===n.bufferView&&void 0===n.sparse?Promise.resolve(null):(void 0!==n.bufferView?a.push(this._parse("bufferView",n.bufferView)):a.push(null),void 0!==n.sparse&&(a.push(this._parse("bufferView",n.sparse.indices.bufferView)),a.push(this._parse("bufferView",n.sparse.values.bufferView))),Promise.all(a).then((function(e){let a,r,i=e[0],s=I[n.componentType],o=G[n.type],l=o*s.BYTES_PER_ELEMENT,c=n.byteOffset,d=t.bufferViews[n.bufferView],h=d.byteStride,u=!0===n.normalized;if(void 0!==h&&h!==l?(r=new s(i,0,n.count*h/s.BYTES_PER_ELEMENT),a=new T.BufferAttribute(r,o,u,h,c,d.target)):(r=null===i?new s(n.count*o):new s(i,c,o*n.count),a=new T.BufferAttribute(r,o,u,0,0,d.target)),void 0!==n.sparse){let t=G.SCALAR,r=I[n.sparse.indices.componentType],i=o,l=s,c=n.sparse.indices.byteOffset,d=n.sparse.values.byteOffset,h=new r(e[1],c,n.sparse.count*t),u=new l(e[2],d,n.sparse.count*i);for(let e=0,t=h.length;e<t;e++){let t=h[e];a.array[t*i]=u[e*i],i>=2&&(a.array[t*i+1]=u[e*i+1]),i>=3&&(a.array[t*i+2]=u[e*i+2]),i>=4&&(a.array[t*i+3]=u[e*i+3])}}return a})))}parseBufferView(e){let t=this._data.bufferViews[e];return this._parse("buffer",t.buffer).then((function(e){let n=t.byteLength||0,a=t.byteOffset||0,r=a,i=a+n;return e.slice(r,i)}))}parseBuffer(e){let t=this._data.buffers[e],n=/^data:(.*?)(;base64)?,(.*)/.exec(t.uri);if(n){let e=n[3],t=!!n[2];e=decodeURIComponent(e),t&&(e=atob(e));let a=new Uint8Array(e.length);for(let t=0,n=e.length;t<n;t++)a[t]=e.charCodeAt(t);return Promise.resolve(a.buffer)}return t.uri?this._loader.load(t.uri):this._type===W?Promise.resolve(this._binaryReader.body):void 0}}n(23);function X(e){return r.a.createElement("div",{className:"layer",onClick:e.onClick},e.children)}n(24);function Q(){return s.a.createPortal(r.a.createElement(X,null,r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"spinner-circle"}))),document.body)}n(25);var Z=function(e){function t(e){var n;return u()(this,t),(n=g()(this,y()(t).call(this,e))).fileInputRef=r.a.createRef(),n.state={loading:!1},n}return w()(t,e),f()(t,[{key:"loadGltfFromFiles",value:function(e){if(e&&e.length>0){for(var t,n={},a=0,r=e.length;a<r;a++){var i=e[a],s=_.a.extname(i.name).slice(1);n[i.name]=i,"gltf"!==s&&"glb"!==s||(t=i)}if(!t){var o="请上传.gltf或.glb文件！";return alert(o),Promise.reject(o)}var l=[],c=new P({urlModifier:function(e){if(e in n){var t=URL.createObjectURL(n[e]);return l.push(t),t}return e}}),d=new J({loader:c}),h=c.load(t.name).then((function(e){return d.parse(e)}));return l.forEach((function(e){URL.revokeObjectURL(e)})),h}}},{key:"loadGltfFromUrl",value:function(e){var t=this,n=_.a.extname(e).toLowerCase();if(".gltf"!==n&&".glb"!==n)return Promise.reject("文件格式不正确");var a=new P({baseUrl:_.a.dirname(e)}),r=new J({loader:a});return this.setState({loading:!0}),a.load(_.a.basename(e)).then((function(e){return t.setState({loading:!1}),r.parse(e)}))}},{key:"open",value:function(){var e=this,t=this.fileInputRef.current;return t?(t.click(),new Promise((function(t,n){e.onceFileInputChange((function(e){e.files.length>0?t(e.files):n("取消")})),setTimeout((function(){n("操作超时！")}),3e4)})).then((function(t){return e.loadGltfFromFiles(t)}))):Promise.reject("File Input 未完成加载！")}},{key:"openUrl",value:function(){var e=prompt("请输入gltf或glb文件地址");return e?this.loadGltfFromUrl(e):Promise.reject("输入已取消")}},{key:"onceFileInputChange",value:function(e){var t=this.fileInputRef.current;t&&t.addEventListener("change",(function n(){t.removeEventListener("change",n),e(t)}),!1)}},{key:"componentDidMount",value:function(){var e=location.search.match(/gltf=([^&]*)/),t=this.props.onSuccess;e&&t&&this.loadGltfFromUrl(e[1]).then(t)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.loading&&r.a.createElement(Q,null),r.a.createElement("input",{type:"file",name:"gltfFile",style:{display:"none"},ref:this.fileInputRef,multiple:!0}))}}]),t}(r.a.Component);n(26);class $ extends r.a.Component{constructor(e){super(e),this.state={gltf:e.gltf},this.webglCanvas=r.a.createRef(),this.webglRenderer=null,this._activeCameraType=null,this._mixer=null,this._cameras=null,this._controllers=null,this._clock=null}getSceneBox(){let e=this.props.gltf,t=e.scenes[e.scene];return(new T.Box3).setFromObject(t)}setActiveCameraType(e){this._activeCameraType=e}setViewType(e){let t=this.props.gltf;t.scenes[t.scene].traverse((function(t){t.material&&("mesh"===e?t.material.wireframe=!1:"wireframe"===e&&(t.material.wireframe=!0))}))}stopRender(){if(cancelAnimationFrame(this._animationTimer),this._cameras=null,this._controllers)for(let e in this._controllers)this._controllers[e].destroy();this._mixer&&this._mixer.destroy()}pause(){this._clock.stop()}resume(){this._clock.start()}renderGltf(e,t){console.log("gltf:",e),this.stopRender();let n=this.props,a=e.scenes[e.scene],r=this.webglRenderer;this.setViewType(n.viewType);let i=this.getSceneBox(),s=i.getSize(),o=s.length(),l=i.getCenter(),c=this.webglCanvas.current,d=c.width,h=c.height,u=o/100,m=10*o,f=T.mathUtils.degToRad(90),p=d/h,g=Math.tan(f/2)*o,E=g*p;console.log("Scene Size:",s),console.log("length:",o),console.log("Scene center:",l),this._cameras={[T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA]:new T.PerspectiveCamera(f,p,u,m),[T.constants.OBJECT_TYPE_ORTHOGRAPHIC_CAMERA]:new T.OrthographicCamera(-E,E,g,-g,u,m)};for(let e in this._cameras){let t=this._cameras[e];t.position.copy(l),t.position.z+=o,t.lookAt(l),t.updateWorldMatrix()}this._controllers={};for(let e in this._cameras){let t=this._cameras[e],n=new T.OrbitController(t,r.domElement);n.target=l.clone();let a=u,i=m-5*o;t.type===T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA?(n.minDistance=a,n.maxDistance=i):t.type===T.constants.OBJECT_TYPE_ORTHOGRAPHIC_CAMERA&&(n.maxZoom=o/(Math.tan(f/2)*a),n.minZoom=o/(Math.tan(f/2)*i)),this._controllers[t.type]=n}e.animations&&e.animations.length>0&&(this._mixer=new T.AnimationMixer([e.animations[0]]),this._clock=new T.Clock),a.traverse((function(e){if(!0===e.isCameraHelper){let t=(new T.Box3).setFromObject(e).getSize(),n=new T.Vec3(.2,.2,.2);n.multiply(s).divide(t),e.update(n)}}));let y=new T.Scene,v=o/10,w=new T.GridHelper(100*v,100);console.log(`gridWidth = ${v}`),y.add(w),this.setActiveCameraType(t);const C=()=>{this._animationTimer=requestAnimationFrame(C),n.beforeRender&&n.beforeRender(),this.webglRenderer.clear(),this._mixer&&this._mixer.update(this._clock.getDeltaTime());let e=this._cameras[this._activeCameraType];this.webglRenderer.render(y,e),this.webglRenderer.render(a,e),n.afterRender&&n.afterRender()};C()}startRenderLater(){clearTimeout(this._startRenderTimer),this._startRenderTimer=setTimeout(()=>{let e=this.props,t=e.gltf;t&&(this.stopRender(),this.webglRenderer.setViewport(0,0,e.width,e.height),this.renderGltf(t,e.activeCameraType))},100)}componentDidMount(){let e=this.webglCanvas.current;this.webglRenderer=new T.WebGLRenderer({canvas:e,autoClearColor:!1});let t=window.getComputedStyle(e).backgroundColor;this.webglRenderer.setClearColor(new T.Color(t)),this.startRenderLater()}componentWillUnmount(){this.stopRender(),this.webglRenderer.destroy()}componentDidUpdate(e){let t=this.props;e.gltf!==t.gltf?this.startRenderLater():e.width===t.width&&e.height===t.height||this.webglRenderer.setViewport(0,0,t.width,t.height)}render(){let e=this.props,t=e.width,n=e.height;return r.a.createElement("canvas",{ref:this.webglCanvas,width:t,height:n,className:"gltf-renderer"})}}n(27),n(28);var ee=function(e){function t(){return u()(this,t),g()(this,y()(t).apply(this,arguments))}return w()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t="panel ".concat(e.className);return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"name"},e.title),r.a.createElement("div",{className:"tools"})),r.a.createElement("div",{className:"body",style:e.height?{height:e.height-30}:null},e.children))}}]),t}(r.a.Component);const{OBJECT_TYPE_MESH:te,OBJECT_TYPE_PERSPECTIVE_CAMERA:ne,OBJECT_TYPE_ORTHOGRAPHIC_CAMERA:ae}=T.constants,re={default:"empty-object",[te]:"mesh",[ne]:"camera",[ae]:"camera"};class ie extends r.a.Component{constructor(e){super(e),this.state={expanded:!1,visible:e.node.visible},this.handleExpandAndCollapse=this.handleExpandAndCollapse.bind(this),this.handleSelect=this.handleSelect.bind(this),this.toggleVisibility=this.toggleVisibility.bind(this)}getNodeName(e){let t=e.name;return t||(t=e.constructor.name+"."+e.uid),t}handleExpandAndCollapse(e){e.preventDefault(),e.stopPropagation();let t=!this.state.expanded;this.setState({expanded:t})}handleSelect(e){e.preventDefault(),e.stopPropagation(),this.props.onSelectNode&&this.props.onSelectNode(this.props.node.uid)}createIcon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re.default,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return r.a.createElement("i",{className:`icon-${e}`,key:t,onClick:n})}toggleVisibility(e){e.preventDefault(),e.stopPropagation();let t=!this.state.visible;this.props.node.visible=t,this.setState({visible:t})}render(){let e,t=this.props,n=this.state,a=t.node,i=t.level,s=this.getNodeName(a),o=n.expanded,l=n.visible,c="node",d=[],h=[];t.selectedNode===a.uid&&(c+=" selected"),a.children.length>0&&(c+=o?" expanded":" collapsed",h.push(this.createIcon(o?"collapse":"expand",h.length,this.handleExpandAndCollapse)),e=r.a.createElement("div",{className:"node-children"},a.children.map(e=>r.a.createElement(ie,{node:e,level:i+1,key:e.uid,onSelectNode:t.onSelectNode,selectedNode:t.selectedNode})))),a.isCameraHelper?h.push(this.createIcon("camera",h.length)):h.push(this.createIcon(re[a.type],h.length));for(let e=0;e<i;e++)d.push(r.a.createElement("div",{className:"indent-guide",key:e}));return r.a.createElement("div",{className:c},r.a.createElement("div",{className:"node-label",onClick:this.handleSelect},r.a.createElement("div",{className:"indent"},d),h,r.a.createElement("div",{className:"node-name"},s),r.a.createElement("i",{className:l?"icon-visible":"icon-hidden",onClick:this.toggleVisibility})),e)}}class se extends r.a.Component{constructor(e){super(e)}render(){let e=this.props,t=e.gltf,n=t&&t.scenes[t.scene].children;return r.a.createElement(ee,{className:"gltf-node-viewer",title:"节点大纲",height:e.height},r.a.createElement("div",{className:"node-list-wrapper"},r.a.createElement("div",{className:"node-list"},n&&n.map(t=>r.a.createElement(ie,{node:t,level:0,key:t.uid,onSelectNode:e.onSelectNode,selectedNode:e.selectedNode})))))}}n(29);var oe,le=function(e){function t(){return u()(this,t),g()(this,y()(t).apply(this,arguments))}return w()(t,e),f()(t,[{key:"formatValue",value:function(e){var t=e%1,n=Math.abs(e-t),a=0;return 0!==t&&(a=5-n.toString().length),a<0&&(a=0),e.toFixed(a)}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.unit;return r.a.createElement("div",{className:"slide-input"},r.a.createElement("span",{className:"value"},this.formatValue(t)),r.a.createElement("span",{className:"unit"},n))}}]),t}(r.a.Component),ce=(n(30),{position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:0,y:0,z:0}}),de={position:"m",rotation:"°",scale:"",Fovy:"°",Aspect:"",Near:"m",Far:"m"},he={rotation:T.mathUtils.radToDeg,Fovy:T.mathUtils.radToDeg},ue=function(e){function t(){return u()(this,t),g()(this,y()(t).apply(this,arguments))}return w()(t,e),f()(t,[{key:"formatValue",value:function(e,t){var n=he[t];return n?n(e):e}},{key:"render",value:function(){var e=this,t=this.props,n=t.gltf,a=t.selectedNode,i=ce;if(n&&a){var s=n.scenes[n.scene];i=s.getChildByUid(a)}return r.a.createElement(ee,{className:"gltf-node-property-viewer",title:"物体属性",height:t.height},i.isCameraHelper&&r.a.createElement("div",{className:"input-group"},["Fovy","Aspect","Near","Far"].map((function(t){return r.a.createElement("div",{className:"input-wrapper",key:t},r.a.createElement("label",{className:"input-name"},t),r.a.createElement(le,{value:e.formatValue(i.camera[t.toLowerCase()],t),unit:de[t]}))}))),["Position","Rotation","Scale"].map((function(t){var n=t.toLowerCase(),a=i[n];return r.a.createElement("div",{className:"input-group",key:t},["x","y","z"].map((function(i,s){return r.a.createElement("div",{className:"input-wrapper",key:i},r.a.createElement("label",{className:"input-name"},(0===s?t:"")+" "+i.toUpperCase()),r.a.createElement(le,{value:e.formatValue(a[i],n),unit:de[n]}))})))})))}}]),t}(r.a.Component),me=n(10),fe=n.n(me),pe=n(13),ge=n.n(pe),Ee=window.performance&&window.performance.memory,ye=function(e){function t(e){var n;return u()(this,t),(n=g()(this,y()(t).call(this,e))).state={path:"",data:[],max:-1/0,min:1/0,cur:0},n.textPadding=[2,0,0,3],n.diagramPadding=[0,3,3,3],n.textOffset={left:n.textPadding[3],top:n.textPadding[0],width:e.width-n.textPadding[1]-n.textPadding[3],height:e.height/3-n.textPadding[0]-n.textPadding[2]},n.diagramOffset={left:n.diagramPadding[3],top:e.height/3+n.diagramPadding[0],width:e.width-n.diagramPadding[1]-n.diagramPadding[3],height:2*e.height/3-n.diagramPadding[0]-n.diagramPadding[2]},n}return w()(t,e),f()(t,[{key:"update",value:function(e){var t=this.state.max,n=this.state.min;e>t?t=e:e<n&&(n=e);var a=this.state.data,r=[].concat(ge()(a),[e]),i=this.diagramOffset,s=i.width;r.length>s&&r.shift();for(var o="",l=i.top+i.height,c=i.left+i.width,d=s-r.length,h=r.length-1;h>=0;h--){var u=r[h],m=h+d,f=i.left+m,p=l-(u-0)/(t-0)*i.height;h===r.length-1?o+="M ".concat(f," ").concat(p):o+="L ".concat(f," ").concat(p)}o+="V ".concat(l," H ").concat(c," Z"),this.setState({cur:e,data:r,path:o,max:t,min:n})}},{key:"render",value:function(){var e=this.props,t=this.state,n=this.textOffset,a={display:e.hide?"none":"",backgroundColor:e.backgroundColor},i={fill:e.fontColor,fontSize:9,fontFamily:"Helvetica,Arial,sans-serif",fontWeight:"bold",dominantBaseline:"hanging"},s=n.left,o=n.top,l={fill:e.fontColor},c=t.min===1/0?"?":Math.round(t.min),d=t.max===-1/0?"?":Math.round(t.max);return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,style:a},r.a.createElement("text",{x:s,y:o,style:i},Math.round(t.cur)," (",e.name,") ",c,"-",d),r.a.createElement("path",{d:t.path,style:l}))}}]),t}(r.a.Component),ve=0,we=0,Ce=function(e){function t(e){var n;return u()(this,t),(n=g()(this,y()(t).call(this,e))).state={currentPanel:0},n.handleClick=n.handleClick.bind(fe()(n)),n.panels=[{name:"FPS",ref:r.a.createRef(),backgroundColor:"#002",fontColor:"#0ff"},{name:"MS",ref:r.a.createRef(),backgroundColor:"#020",fontColor:"#0f0"}],Ee&&n.panels.push({name:"MB",ref:r.a.createRef(),backgroundColor:"#201",fontColor:"#f08"}),n}return w()(t,e),f()(t,[{key:"now",value:function(){return(performance||Date).now()}},{key:"handleClick",value:function(){var e=this.state.currentPanel;this.selectPanel(++e%this.panels.length)}},{key:"begin",value:function(){oe=this.now()}},{key:"end",value:function(){var e,t=this.getPannelByName("MS").ref.current,n=this.getPannelByName("FPS").ref.current;Ee&&(e=this.getPannelByName("MB").ref.current);var a=this.now();if(t.update(a-oe),we++,a-ve>=1e3&&(n.update(1e3*we/(a-ve)),ve=a,we=0,Ee)){var r=performance.memory,i=r.usedJSHeapSize/1048576;r.jsHeapSizeLimit;e.update(i)}}},{key:"selectPanel",value:function(e){this.setState({currentPanel:e})}},{key:"getPannelByName",value:function(e){for(var t=0,n=this.panels.length;t<n;t++){var a=this.panels[t];if(a.name===e)return a}}},{key:"render",value:function(){var e=this,t=this.props,n={position:"fixed",left:t.left,top:t.top,right:t.right,bottom:t.bottom,zIndex:999};return r.a.createElement("div",{onClick:this.handleClick,style:n},this.panels.map((function(t,n){return r.a.createElement(ye,{width:"80",height:"48",key:t.name,ref:t.ref,name:t.name,backgroundColor:t.backgroundColor,fontColor:t.fontColor,hide:n!==e.state.currentPanel})})))}}]),t}(r.a.Component),_e=n(11),Ae=n.n(_e);n(37);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pe(e){return r.a.createElement("li",{className:"menu-item",onClick:function(t){e.onClick&&e.onClick(t,{key:e.uKey})}},r.a.createElement("span",{className:"command"+(e.checked?" checked":"")},e.checked&&r.a.createElement("i",{className:"icon-tick"}),r.a.createElement("span",{className:"command-name"},e.text),r.a.createElement("span",{className:"command-short-cut"},e.secondaryText)))}function Te(e){const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.position),[n,a]=r.a.useState(!0);return s.a.createPortal(r.a.createElement(X,{onClick:function(e){e.preventDefault(),a(!n)}},r.a.createElement("ul",{className:"menu",style:t},e.items.map(e=>{if(e.itemType===ke.separator)return r.a.createElement("li",{className:"menu-separator",key:e.key});{let t=e.canCheck&&e.isChecked;return r.a.createElement(Pe,{checked:t,key:e.key,uKey:e.key,onClick:e.onClick,text:e.text,secondaryText:e.secondaryText})}}))),document.body)}const ke={separator:0};n(38);function Ne(e){var t=e.menuProps,n=r.a.useState(!1),a=Ae()(n,2),i=a[0],s=a[1],o=r.a.useState({}),l=Ae()(o,2),c=l[0],d=l[1],h=r.a.useRef(null);return r.a.createElement("button",{className:"button ".concat(i?"selected":""),onClick:function(n){if(t){var a=h.current.getBoundingClientRect(),r={left:a.left,top:a.top+a.height};d(r),s(!i)}e.onClick&&e.onClick(n,h.current)},ref:h},r.a.createElement("span",{className:"button-label"},e.text),t&&i&&r.a.createElement(Te,{items:t.items,position:c}))}n(39);function Me(e){return r.a.createElement("ul",{className:"command-bar"},e.items.map((function(e){return r.a.createElement(Ne,{key:e.key,text:e.text,menuProps:e.subMenuProps})})))}var Se=new(function(){function e(){u()(this,e),this._commands={}}return f()(e,[{key:"getCommand",value:function(e){return this._commands[e]}},{key:"registerCommand",value:function(e,t){this._commands[e]=t}},{key:"unregisterCommand",value:function(e){delete this._commands[e]}},{key:"executeCommand",value:function(e){for(var t=this.getCommand(e),n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return t&&t.apply(void 0,a)}},{key:"destory",value:function(){}}]),e}());const Re=r.a.createContext();n(40);var Oe=n(14),Ue=n.n(Oe);function Le(){Se.executeCommand("closeWin")}function Fe(){Se.executeCommand("minimizeWin")}function Ke(){Se.executeCommand("restoreWin")}function De(e){const t=[{key:"functions",text:"操作",subMenuProps:{items:[{key:"openLocalGLTF",text:"打开Gltf/Glb文件",secondaryText:"Ctrl+O",onClick:function(){Se.executeCommand("open")},canCheck:!1},{key:"openRemoteGLTF",text:"打开远程Gltf/Glb文件",secondaryText:"Ctrl+Shift+O",onClick:function(){Se.executeCommand("openUrl")},canCheck:!1},{key:"separator_1",itemType:ke.separator},{key:"setPerspectiveCamera",text:"Perspective相机",secondaryText:"P",onClick:function(){Se.executeCommand("renderer.setActiveCameraType",T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA)},canCheck:!0,isChecked:e.activeCameraType===T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA},{key:"setOrthographicCamera",text:"Orthographic相机",secondaryText:"O",onClick:function(){Se.executeCommand("renderer.setActiveCameraType",T.constants.OBJECT_TYPE_ORTHOGRAPHIC_CAMERA)},canCheck:!0,isChecked:e.activeCameraType===T.constants.OBJECT_TYPE_ORTHOGRAPHIC_CAMERA},{key:"separator_2",itemType:ke.separator},{key:"setMeshView",text:"Mesh视图",secondaryText:"M",onClick:function(){Se.executeCommand("renderer.setViewType","mesh")},canCheck:!0,isChecked:"mesh"===e.viewType},{key:"setWireframeView",text:"Wireframe视图",secondaryText:"W",onClick:function(){Se.executeCommand("renderer.setViewType","wireframe")},canCheck:!0,isChecked:"wireframe"===e.viewType}]}}];return r.a.createElement("div",{className:"top-bar"},r.a.createElement("img",{src:Ue.a,height:"20",alt:"glTF",className:"logo"}),r.a.createElement(Me,{items:t}),r.a.createElement("h1",{className:"app-title"},"GlTF2 Viewer"),r.a.createElement(Re.Consumer,null,e=>"electron"===e&&r.a.createElement("div",{className:"window-controls-container"},r.a.createElement("span",{className:"window-control icon-chrome-minimize",onClick:Fe}),r.a.createElement("span",{className:"window-control icon-chrome-restore",onClick:Ke}),r.a.createElement("span",{className:"window-control icon-chrome-close",onClick:Le}))))}n(41);var Ye=function(e){function t(){return u()(this,t),g()(this,y()(t).apply(this,arguments))}return w()(t,e),f()(t,[{key:"makeInfo",value:function(e){var t={vertices:0,faces:0,triangles:0,objects:0};e&&e.scenes[e.scene].traverse((function(e){t.objects++,e.geometry&&(t.vertices+=e.geometry._attributes.position.count)}));return t}},{key:"render",value:function(){var e=this.props.gltf,t=this.makeInfo(e);return r.a.createElement("div",{className:"status-bar"},r.a.createElement("ul",{className:"info"},r.a.createElement("li",null,r.a.createElement("span",{className:"info-key"},"Vertices:"),r.a.createElement("span",{className:"info-value"},t.vertices)),r.a.createElement("li",null,r.a.createElement("span",{className:"info-key"},"Objects:"),r.a.createElement("span",{className:"info-value"},t.objects))))}}]),t}(r.a.Component);function xe(){return(performance||Date).now()}n(42);class Be extends r.a.Component{constructor(e){super(e),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseMove=function(e,t){let n,a,{leading:r=!0,trailing:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=0;function o(t,r){s=xe(),n=null,a=e.apply(t,r)}function l(){let l,c=xe();0===s&&!1===r&&(s=c),l=t-(c-s);for(var d=arguments.length,h=new Array(d),u=0;u<d;u++)h[u]=arguments[u];return l<=0?(s=c,a=e.apply(this,h)):n||!1===i||(n=setTimeout(o,l,this,h)),a}return l.cancel=function(){clearTimeout(n),s=0,n=null},l}(this.handleMouseMove.bind(this),17)}handleMouseDown(e){this._resizing=!0,this._resizeDirection=e.target.dataset.direction,this._lastPosition=this._getMousePosition(e)}handleMouseUp(){this._resizing=!1}handleMouseMove(e){if(!this._resizing)return;let t=this._getMousePosition(e),n=t-this._lastPosition,a=this._resizeDirection,r=this.props.onResize;r&&r({deltaSize:n,direction:a}),this._lastPosition=t}_getMousePosition(e){return"x"===this._resizeDirection?e.clientX:"y"===this._resizeDirection?e.clientY:void 0}componentDidMount(){window.addEventListener("mouseup",this.handleMouseUp,!1),window.addEventListener("mousemove",this.handleMouseMove,!1)}componentWillUnmount(){window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove)}render(){let e=this.props,t=e.resizeX,n=e.resizeY;return r.a.createElement("div",{className:"resize-helper"},e.children,t&&r.a.createElement("div",{className:"resize-helper-x","data-direction":"x",onMouseDown:this.handleMouseDown}),n&&r.a.createElement("div",{className:"resize-helper-y","data-direction":"y",onMouseDown:this.handleMouseDown}))}}var Ve={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,LeftWinKey:91,RightWinKey:92,ContextMenu:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_SEPARATOR:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,US_SEMICOLON:186,US_EQUAL:187,US_COMMA:188,US_MINUS:189,US_DOT:190,US_SLASH:191,US_BACKTICK:192,ABNT_C1:193,ABNT_C2:194,US_OPEN_SQUARE_BRACKET:219,US_BACKSLASH:220,US_CLOSE_SQUARE_BRACKET:221,US_QUOTE:222,OEM_8:223,OEM_102:226,KEY_IN_COMPOSITION:229},Ie=navigator.userAgent.indexOf("Macintosh")>-1,Ge=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,ze=navigator.userAgent.toLowerCase().indexOf("AppleWebKit")>-1;Ge?(Ve.US_SEMICOLON=59,Ve.US_EQUAL=107,Ve.US_MINUS=109,Ie&&(Ve.Meta=224)):ze&&(Ve.Meta=91,Ve.Meta=Ie?93:92);var je=new(function(){function e(){u()(this,e),this._keyCodeToStr=[],this._strToKeyCode={}}return f()(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||Ve.Unknown}}]),e}());function He(e){return je.keyCodeToStr(e)}je.define(Ve.Unknown,"unknown"),je.define(Ve.Backspace,"Backspace"),je.define(Ve.Tab,"Tab"),je.define(Ve.Enter,"Enter"),je.define(Ve.Shift,"Shift"),je.define(Ve.Ctrl,"Ctrl"),je.define(Ve.Alt,"Alt"),je.define(Ve.PauseBreak,"PauseBreak"),je.define(Ve.CapsLock,"CapsLock"),je.define(Ve.Escape,"Escape"),je.define(Ve.Space,"Space"),je.define(Ve.PageUp,"PageUp"),je.define(Ve.PageDown,"PageDown"),je.define(Ve.End,"End"),je.define(Ve.Home,"Home"),je.define(Ve.LeftArrow,"LeftArrow","Left"),je.define(Ve.UpArrow,"UpArrow","Up"),je.define(Ve.RightArrow,"RightArrow","Right"),je.define(Ve.DownArrow,"DownArrow","Down"),je.define(Ve.Insert,"Insert"),je.define(Ve.Delete,"Delete"),je.define(Ve.KEY_0,"0"),je.define(Ve.KEY_1,"1"),je.define(Ve.KEY_2,"2"),je.define(Ve.KEY_3,"3"),je.define(Ve.KEY_4,"4"),je.define(Ve.KEY_5,"5"),je.define(Ve.KEY_6,"6"),je.define(Ve.KEY_7,"7"),je.define(Ve.KEY_8,"8"),je.define(Ve.KEY_9,"9"),je.define(Ve.KEY_A,"A"),je.define(Ve.KEY_B,"B"),je.define(Ve.KEY_C,"C"),je.define(Ve.KEY_D,"D"),je.define(Ve.KEY_E,"E"),je.define(Ve.KEY_F,"F"),je.define(Ve.KEY_G,"G"),je.define(Ve.KEY_H,"H"),je.define(Ve.KEY_I,"I"),je.define(Ve.KEY_J,"J"),je.define(Ve.KEY_K,"K"),je.define(Ve.KEY_L,"L"),je.define(Ve.KEY_M,"M"),je.define(Ve.KEY_N,"N"),je.define(Ve.KEY_O,"O"),je.define(Ve.KEY_P,"P"),je.define(Ve.KEY_Q,"Q"),je.define(Ve.KEY_R,"R"),je.define(Ve.KEY_S,"S"),je.define(Ve.KEY_T,"T"),je.define(Ve.KEY_U,"U"),je.define(Ve.KEY_V,"V"),je.define(Ve.KEY_W,"W"),je.define(Ve.KEY_X,"X"),je.define(Ve.KEY_Y,"Y"),je.define(Ve.KEY_Z,"Z"),je.define(Ve.Meta,"Meta"),je.define(Ve.ContextMenu,"ContextMenu"),je.define(Ve.F1,"F1"),je.define(Ve.F2,"F2"),je.define(Ve.F3,"F3"),je.define(Ve.F4,"F4"),je.define(Ve.F5,"F5"),je.define(Ve.F6,"F6"),je.define(Ve.F7,"F7"),je.define(Ve.F8,"F8"),je.define(Ve.F9,"F9"),je.define(Ve.F10,"F10"),je.define(Ve.F11,"F11"),je.define(Ve.F12,"F12"),je.define(Ve.F13,"F13"),je.define(Ve.F14,"F14"),je.define(Ve.F15,"F15"),je.define(Ve.F16,"F16"),je.define(Ve.F17,"F17"),je.define(Ve.F18,"F18"),je.define(Ve.F19,"F19"),je.define(Ve.NumLock,"NumLock"),je.define(Ve.ScrollLock,"ScrollLock"),je.define(Ve.US_SEMICOLON,";",";","OEM_1"),je.define(Ve.US_EQUAL,"=","=","OEM_PLUS"),je.define(Ve.US_COMMA,",",",","OEM_COMMA"),je.define(Ve.US_MINUS,"-","-","OEM_MINUS"),je.define(Ve.US_DOT,".",".","OEM_PERIOD"),je.define(Ve.US_SLASH,"/","/","OEM_2"),je.define(Ve.US_BACKTICK,"`","`","OEM_3"),je.define(Ve.ABNT_C1,"ABNT_C1"),je.define(Ve.ABNT_C2,"ABNT_C2"),je.define(Ve.US_OPEN_SQUARE_BRACKET,"[","[","OEM_4"),je.define(Ve.US_BACKSLASH,"\\","\\","OEM_5"),je.define(Ve.US_CLOSE_SQUARE_BRACKET,"]","]","OEM_6"),je.define(Ve.US_QUOTE,"'","'","OEM_7"),je.define(Ve.OEM_8,"OEM_8"),je.define(Ve.OEM_102,"OEM_102"),je.define(Ve.NUMPAD_0,"NumPad0"),je.define(Ve.NUMPAD_1,"NumPad1"),je.define(Ve.NUMPAD_2,"NumPad2"),je.define(Ve.NUMPAD_3,"NumPad3"),je.define(Ve.NUMPAD_4,"NumPad4"),je.define(Ve.NUMPAD_5,"NumPad5"),je.define(Ve.NUMPAD_6,"NumPad6"),je.define(Ve.NUMPAD_7,"NumPad7"),je.define(Ve.NUMPAD_8,"NumPad8"),je.define(Ve.NUMPAD_9,"NumPad9"),je.define(Ve.NUMPAD_MULTIPLY,"NumPad_Multiply"),je.define(Ve.NUMPAD_ADD,"NumPad_Add"),je.define(Ve.NUMPAD_SEPARATOR,"NumPad_Separator"),je.define(Ve.NUMPAD_SUBTRACT,"NumPad_Subtract"),je.define(Ve.NUMPAD_DECIMAL,"NumPad_Decimal"),je.define(Ve.NUMPAD_DIVIDE,"NumPad_Divide");var We=[{key:"O",command:"renderer.setActiveCameraType",args:2},{key:"P",command:"renderer.setActiveCameraType",args:1},{key:"M",command:"renderer.setViewType",args:"mesh"},{key:"W",command:"renderer.setViewType",args:"wireframe"},{key:"Ctrl+O",command:"open"},{key:"Ctrl+Shift+O",command:"openUrl"},{key:"Ctrl+Shift+I",command:"openDevTools"}];function qe(e){var t=function(e){e.preventDefault();var t=e.keyCode,n=e.ctrlKey,a=e.shiftKey,r=e.altKey,i=e.metaKey,s=[];n&&s.push(He(Ve.Ctrl)),a&&s.push(He(Ve.Shift)),r&&s.push(He(Ve.Alt)),i&&s.push(He(Ve.Meta)),s.push(He(t)),s=s.join("+");for(var o=We.length-1;o>=0;o--){var l=We[o];if(l.key===s){var c=Se.getCommand(l.command),d=l.args;c&&c(d)}}};return Object(a.useEffect)((function(){var n=e.target||window;return n.addEventListener("keydown",t),function(){return n.removeEventListener("keydown",t)}})),r.a.createElement(r.a.Fragment,null,e.children)}n(43);function Je(){return r.a.createElement("div",{className:"keybinding-tip"},r.a.createElement("svg",{className:"file-upload-icon",xmlns:"http://www.w3.org/2000/svg",width:"100",height:"86",viewBox:"0 0 50 43"},r.a.createElement("path",{d:"M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"})),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",{className:"keybinding-name"},"打开文件"),r.a.createElement("span",{className:"keybinding-short-cut"},r.a.createElement("span",{className:"keybinding-key"},"Ctrl"),r.a.createElement("span",{className:"keybinding-separator"},"+"),r.a.createElement("span",{className:"keybinding-key"},"O"))),r.a.createElement("li",null,r.a.createElement("span",{className:"keybinding-name"},"打开URL"),r.a.createElement("span",{className:"keybinding-short-cut"},r.a.createElement("span",{className:"keybinding-key"},"Ctrl"),r.a.createElement("span",{className:"keybinding-separator"},"+"),r.a.createElement("span",{className:"keybinding-key"},"Shift"),r.a.createElement("span",{className:"keybinding-separator"},"+"),r.a.createElement("span",{className:"keybinding-key"},"O"))),r.a.createElement("li",null,r.a.createElement("span",{className:"keybinding-name"},"旋转镜头"),r.a.createElement("span",{className:"keybinding-short-cut"},r.a.createElement("span",{className:"keybinding-mouse"},r.a.createElement("i",{className:"icon-mouse-left"})))),r.a.createElement("li",null,r.a.createElement("span",{className:"keybinding-name"},"移动镜头"),r.a.createElement("span",{className:"keybinding-short-cut"},r.a.createElement("span",{className:"keybinding-key"},"Shitf"),r.a.createElement("span",{className:"keybinding-separator"},"+"),r.a.createElement("span",{className:"keybinding-mouse"},r.a.createElement("i",{className:"icon-mouse-left"}))))))}n(44);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}class Qe extends r.a.Component{constructor(e){super(e),this.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({gltf:null,selectedNode:void 0,showFPS:!1,activeCameraType:T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA,viewType:"mesh",hideFileReader:!1},this.calculateLayout()),this.handleDropOver=this.handleDropOver.bind(this),this.handleDrop=this.handleDrop.bind(this),this.handleWinResize=function(e,t,n){var a,r;function i(t,n){t&&n&&(r=e.apply(t,n)),a=null}function s(){a&&clearTimeout(a);for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];if(n){var c=null===a;c&&(r=e.apply(this,o)),a=setTimeout(i,t)}else a=setTimeout(i,t,this,o);return r}return s.cancel=function(){clearTimeout(a),a=null},s}(this.handleWinResize,100).bind(this),this.renderGltf=this.renderGltf.bind(this),this.setSelectedNode=this.setSelectedNode.bind(this),this.changeNodeViewerHeight=this.changeNodeViewerHeight.bind(this),this.changeSideBarWidth=this.changeSideBarWidth.bind(this),this.setViewType=this.setViewType.bind(this),this.setActiveCameraType=this.setActiveCameraType.bind(this),this.open=this.open.bind(this),this.openUrl=this.openUrl.bind(this),this.stats=r.a.createRef(),this.gltfLoaderRef=r.a.createRef(),this.rendererRef=r.a.createRef()}renderGltf(e){e&&this.setState({gltf:e,selectedNode:void 0,hideFileReader:!0,activeCameraType:T.constants.OBJECT_TYPE_PERSPECTIVE_CAMERA,viewType:"mesh"})}handleDropOver(e){e.preventDefault()}handleDrop(e){e.preventDefault();let t=this.gltfLoaderRef.current;t&&t.loadGltfFromFiles(e.dataTransfer.files).then(this.renderGltf)}setViewType(e){let t=this.rendererRef.current;t&&(t.setViewType(e),this.setState({viewType:e}))}setActiveCameraType(e){let t=this.rendererRef.current;t&&(t.setActiveCameraType(e),this.setState({activeCameraType:e}))}open(){let e=this.gltfLoaderRef.current;e&&e.open().then(this.renderGltf)}openUrl(){let e=this.gltfLoaderRef.current;e&&e.openUrl().then(this.renderGltf)}setSelectedNode(e){this.setState({selectedNode:e})}changeSideBarWidth(e){let{deltaSize:t}=e,n=this.state.sideBarLayout.width+t;this.setState(this.calculateLayout({sideBarWidth:n}))}changeNodeViewerHeight(e){let{deltaSize:t}=e,n=this.state.nodeViewerLayout.height+t;this.setState(this.calculateLayout({nodeViewerHeight:n}))}handleWinResize(){let e=this.state.sideBarLayout.width,t=this.state.nodeViewerLayout.height;this.setState(this.calculateLayout({sideBarWidth:e,nodeViewerHeight:t}))}calculateLayout(){let{topBarHeight:e=30,statusBarHeight:t=20,sideBarWidth:n=240,nodeViewerHeight:a=560}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=window.innerWidth,i=window.innerHeight;return{sideBarLayout:{width:n},rendererLayout:{width:r-n,height:i-e-t},nodeViewerLayout:{height:a},nodePropertyViewerLayout:{height:i-e-t-a}}}disableContextMenu(e){e.preventDefault()}componentDidMount(){location.search.indexOf("showFPS=true")>=0&&this.setState({showFPS:!0}),window.addEventListener("resize",this.handleWinResize),window.addEventListener("contextmenu",this.disableContextMenu),Se.registerCommand("renderer.setActiveCameraType",this.setActiveCameraType),Se.registerCommand("renderer.setViewType",this.setViewType),Se.registerCommand("open",this.open),Se.registerCommand("openUrl",this.openUrl)}componentWillUnmount(){window.removeEventListener("resize",this.handleWinResize),window.removeEventListener("contextmenu",this.disableContextMenu),Se.unregisterCommand("renderer.setActiveCameraType"),Se.unregisterCommand("renderer.setViewType"),Se.unregisterCommand("open"),Se.unregisterCommand("openUrl")}render(){let e=this.state,t=e.gltf,n=e.selectedNode;return r.a.createElement(qe,null,r.a.createElement(c,{vertical:!0},r.a.createElement(d,null,r.a.createElement(De,{activeCameraType:e.activeCameraType,viewType:e.viewType})),r.a.createElement(d,{flexGrow:1},r.a.createElement(c,null,r.a.createElement(d,{width:e.sideBarLayout.width},r.a.createElement(Be,{resizeX:!0,onResize:this.changeSideBarWidth},r.a.createElement(c,{vertical:!0},r.a.createElement(d,null,r.a.createElement(Be,{resizeY:!0,onResize:this.changeNodeViewerHeight},r.a.createElement(se,{height:e.nodeViewerLayout.height,gltf:e.gltf,onSelectNode:this.setSelectedNode,selectedNode:n}))),r.a.createElement(d,{flexGrow:1},r.a.createElement(ue,{gltf:e.gltf,selectedNode:n,height:e.nodePropertyViewerLayout.height}))))),r.a.createElement(d,{flexGrow:1},r.a.createElement("div",{onDrop:this.handleDrop,onDragOver:this.handleDropOver},!e.gltf&&r.a.createElement(Je,null),e.showFPS&&r.a.createElement(Ce,{ref:this.stats,right:5,top:36}),r.a.createElement(Z,{ref:this.gltfLoaderRef,onSuccess:this.renderGltf,hide:this.state.hideFileReader}),r.a.createElement($,{ref:this.rendererRef,gltf:e.gltf,selectedNode:e.selectedNode,hide:this.state.hideGltfRenderer,beforeRender:e.showFPS&&(()=>this.stats.current.begin()),afterRender:e.showFPS&&(()=>this.stats.current.end()),width:e.rendererLayout.width,height:e.rendererLayout.height,activeCameraType:e.activeCameraType,viewType:e.viewType}))))),r.a.createElement(d,null,r.a.createElement(Ye,{gltf:t}))))}}var Ze=/(Edge\/(17(?:\.0)?|17(?:\.([1-9]|\d{2,}))?|(1[8-9]|[2-9]\d|\d{3,})(?:\.\d+)?))|(HeadlessChrome((?:\/77\.0\.\d+)?|(?:\/77\.([1-9]|\d{2,})\.\d+)?|(?:\/(7[8-9]|[8-9]\d|\d{3,})\.\d+\.\d+)?))|((Chromium|Chrome)\/(77\.0|77\.([1-9]|\d{2,})|(7[8-9]|[8-9]\d|\d{3,})\.\d+)(?:\.\d+)?)|(Firefox\/(70\.0|70\.([1-9]|\d{2,})|(7[1-9]|[8-9]\d|\d{3,})\.\d+)\.\d+)|(Firefox\/(70\.0|70\.([1-9]|\d{2,})|(7[1-9]|[8-9]\d|\d{3,})\.\d+)(pre|[ab]\d+[a-z]*)?)/;s.a.render(r.a.createElement(Re.Provider,{value:"web"},Ze.test(navigator.userAgent)?r.a.createElement(Qe,null):r.a.createElement((function(){return r.a.createElement("div",{style:{color:"black"}},"本应用只支持chrome、firefox、edge浏览器，请更换浏览器！")}),null)),document.getElementById("root"))}]);